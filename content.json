[{"title":"","date":"2019-08-04T03:56:33.462Z","path":"2019/08/04/克里金估计技术的基本原理/","text":"克里金估计技术的基本原理1.研究对象和目的​ 克里金技术的研究对象是空间预测问题，就是利用空间中的一个或者几个变量的观测数据，来估计出这个或者这些变量在该空间中的随位置不同而变化的规律和特征。 ​ 在进行空间数据的预测时会遇到如下几个方面的困难： 由于观测位置和观测数据方法的局限性，以及观测过程中的人为因素，观测所得到的数据都有不同程度的误差 观测数据在空间分布往往是不规则，很难有一定的规律性 和一个变量有关的观测数据往往不止一种，有的直接，有的间接；有的数目较多，有的较少；有的空间变化比较平缓，有的比较剧烈。 空间预测的条件、环境、目的和要求往往是不一样的。 因此需要发展多种方法来适应这种情况 2.数学模型——随机过程及其估计​ 随机过程可以看成是一个随机函数。随机过程的本质有两点：1.随机，2.过程。随机说明任何时候结果都存在随机性，是不确定的；过程体现的是一个时间上的维度，在t1时刻是随机变量服从某一个分布，而到了t2时刻又是服从其他分布。 ​ 随机变量X代表着一种对应关系，对于一个随机试验的每个结果₰，都可以赋予一个数值X(₰)，然而随机过程X(t)则是对于每个₰赋予一个函数X(t，₰)的一种对应关系，所以随机过程是依赖于参量₰的一族时间函数，即他是t和₰的函数。 ​ 如果用X(t)表示随机过程，以省略其对₰的依赖关系，则X(t)具有如下涵义： 它是一族自变量为t和₰的函数X(t，₰) 当₰固定时，X(t，₰)表示的是该过程的一个实现，仅仅是时间t的函数 当t固定时，而₰是变量时，那么X(t)是一个随机变量，代表着该过程在时刻t下的状态 当t和₰都固定时，那么X(t)就是一个确定的数值 随机过程的基本特征：统计特性： 事实上，随机过程是由可数的无穷多个随机变量组成，其中的每一个随机变量对应一个t。对于特定的t，X(t)是一个随机变量，其分布函数为$ F(x,t) =P\\begin{cases}X(t)\\leq x\\end{cases}\\}$ ,此分布函数依赖于t，它等于事件$|x(t)\\leq x|$的概率。该事件是在是在特定的时间t，在该过程的样本$x(t,\\zeta)$中不超过数值x的全部结果$X(t,\\zeta _i)$所组成。 随机过程的数学期望，自相关函数和协方差函数均表达了随机过程的统计特性。 数学期望：它反应随机变量平均取值的大小，对于连续形随机变量$\\zeta$的可能取值为$(-\\infty,+\\infty)$,所以随机过程$E(t)$的数学期望的表达式为$\\eta(t)=E[X(t)]=\\int_{-\\infty}^{+\\infty}xf(x,t)d_x$;对于离散形随机变量$E[X]=\\sum_{k=-\\infty}^{+\\infty}x_kp_k$, 自相关函数：均值和方差只能刻画出随机过程在各个独立时刻的概率统计特性，反应不了随机过程的内在相关性，所以引入了自相关函数，它是为了分辨形状不同的$x(t)$，所以带入$E\\{X(t_1)E(t_2)\\}$公式的值应该就是取两个时刻的函数值自己相乘，这样才能反映出$x(t)$的差异。$R(t_1,t_2)=E[X(t_1)\\cdot E(t_2)]=\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}x_1x_2f(x_1,x_2;t_1.t_2)d_{x_1}d_{x_2}$. 自协方差函数：和自相关函数差不多，描述随机变量$X(t)$在两个不同时刻的取值的起伏变化的相关程度。 $C(t_1,t_2)=E\\{ \\{X(t_1)-E[X(t_1)]\\} \\{X(t_2)-E[X(t_2)]\\} \\}=R(t_1,t_2)-\\eta(t_1)\\eta(t_2)$ 平稳性：是否具有平稳性是随机过程的一个重要性质，具有平稳性的随机过程叫做平稳随机过程。 严格平稳：$F(x_1,x_2,\\cdots,x_n;t_1,t_2,\\cdots,t_n)=F(x_1,x_2,\\cdots,x_n;t_1+c,t_2+c,\\cdots,t_n+c)$即将邻域当成重复取样点，这个假设通常情况下是不符合实际的 二阶平稳：当区域化变量$Z(u)$满足下列2个条件时，称其为二阶平稳或弱平稳 在整个研究区内$Z(u)$的数学期望存在，且是常数，即$E[Z(u)=E[Z(u+h)]=m] \\quad \\forall A \\quad\\forall h$,随机函数在空间上没有明显的变化趋势。 在整个研究区内，$Z(u)$的协方差存在且平稳。即只依赖于滞后h，而与u无关，$Cov\\{Z(u),Z(u+h\\}=E[Z(u)Z(u+h)]-E[Z(u)]E[Z(u+h)]=E[Z(u)Z(u+h)]-m^2=C(h)$，协方差不依赖空间绝对位置，而依赖于相对位置，即空间具有稳定不变性。 本征假设(内蕴假设):它是比二阶平稳假设更弱的假设。 各态历经性：为了求取$X(t)$的数学期望函数，按照概率论的方法，我们需要取得该过程的大量实现，然后求算术平均值，才能得到数学期望函数。但是在实际情况下，很难得到一个过程各个随机变量的大量实现，也就没法通过算术平均来求得数学期望函数。因此需要采用尽可能少的实现，去求取数学期望等各种统计量。对此，具有各态历经性的平稳过程允许用一个实现的时序平均去代替相应过程的总体平均。 估值理论： 最小方差估计 最大验后估计 贝叶斯估计 最大似然估计 线性最小方差估计 空间变量的随机模型及其预测克里金技术解决空间预测问题的过程 将所研究空间变量与一个随机函数$Z(x)$相对应，且让它们的定义域相同，进一步再将空间变量在$x_1,x_2,\\cdots,x_n$等处的观测值$Z(x_1),Z(x_2),\\cdots,Z(x_n)$分别视为随机变量$Z(x_1),Z(x_2),\\cdots,Z(x_n)$的一个实现 利用估计理论，根据$Z(x_1),Z(x_2),\\cdots,Z(x_n)$对随机函数$Z(x)$在$$处的随机变量进行估计，其结果可形式地计为$Z^{*}(x_0)=f[Z(x_1),Z(x_2),\\cdots,Z(x_n)]$，关键是求出函数关系f 将观测值$Z(x_1),Z(x_2),\\cdots,Z(x_n)$分别代替f中的$Z(x_1),Z(x_2),\\cdots,Z(x_n)$，从而得到克里金估计值$Z^*(x_0)$. 线性预测由于克里金技术所研究的空间变量随空间位置不同而变化的复杂性，以及观测数据数目较少而造成的信息不充分，因此需要将函数的一般形式明确完全地确定下来是不可能的，所以我们需要对估计量的形式进行简化，将函数关系f取成$Z(x_1),Z(x_2),\\cdots,Z(x_n)$的线性函数。这样就有了 Z^*(x_0)=\\lambda_0+\\sum_{i=1}^n\\lambda_iZ(x_i)\\quad\\quad(1)为了确定$\\lambda i$的值，需要确定用什么方法去估计，一般采用的是最小方差估计，即： E\\{[Z(x_0)-Z^*(x_0)]^2\\}=min \\quad\\quad(2)当$Z^(x_0)$能够被$Z(x_1),Z(x_2),\\cdots,Z(x_n)$的线性最小方差估计时，获取$Z^(x_0)$的系数也就可以根据$Z(x_1),Z(x_2),\\cdots,Z(x_n)$的一阶矩和二阶矩表示出来，而无需涉及它们的概率密度函数。 先来讨论$Z(x)$的一阶矩如下的三种情况进行讨论 $Z(x)$的数学期望$m(x)=E[Z(x)]$,对所有的x，都是已知的，可以允许当$x!=x_0时,m(x)!=m(x_0)$。 $Z(x)$的数学期望$m(x)$是一个和x无关的常数，但属未知，这时随机函数Z(x)为一阶平稳 $Z(x)$的数学期望$m(x)$即不平稳也不可知 简单克里金(一阶矩是第一种的情况)如果$Z^(x_0)$是线性最小方差估计，那么$Z^(x_0)$是$Z(x_0)$的无偏估计。 E[Z(x_0)-Z^*(x_0)]=E\\{Z(x_0)-[\\lambda_0+\\sum_{i=1}^n\\lambda_iZ(x_i)]\\} \\\\ =m_0-\\lambda_0-\\sum_{i=1}^n\\lambda_im_i=0\\quad\\quad(3)其中$m_i=E[Z(x_i)],i=0,1,2,\\cdots,n$。那么当$\\lambda_i$全部确定后，可以确定$\\lambda_0$为： \\lambda_0 = m_0-\\sum_{i=1}^n\\lambda_im_i\\quad\\quad(4)由（3）交换律。从而有$Z^*(x_0)=m_0+\\sum_{i=1}^n\\lambda_i[Z(x_i)-m_i]\\quad\\quad(5)$ 令$a_0=1,a_i=-\\lambda_i$利用（5）可以得到 Z(x_0)-Z^*(x_0) = \\sum_{i=0}^na_i[Z(x_i)-m_i]\\quad\\quad(6)由（5），估计误差的数学期望为0，从而估计误差的方差为 E\\{[Z(x_0)-Z^*(x_0]^2\\} = E \\{ \\{\\sum_{i=0}^na_i[Z(x_i)-m_i]\\}^2=\\sum_{i=0}^n\\sum_{j=0}^na_ia_jC(x_i,x_j)\\}\\quad\\quad(7)其中$C(x_i,x_j)$就是协方差函数。如果在（7）式中有$\\lambda_1,\\lambda_2,\\cdots,\\lambda_n$的一组数值，使得估计方差为最小，那么这组数值就使下列式成立 \\frac{1}{2}\\frac{\\alpha}{\\alpha\\lambda_j}E\\{[Z(x_0)-Z^*(x_0)]^2\\} \\\\=\\sum_{i=0}^na_iC(x_i,x_i)=0 \\\\由于a_0=1,a_i=-\\lambda_i，那么就有\\\\\\sum_{i=1}^n\\lambda_iC(x_i,x_j) = C(x_0,x_j)\\quad\\quad(8)公式8就是简单克里金方程组，将求得得到$\\lambda_i$带入公式5，即可得到简单克里金的估计量$Z^*(x_0)$。事实上，公式5和6中的$m_i$的假设是已知的。 当然也可以写成矩阵的形式： K\\lambda=k \\quad\\quad (9) K=\\begin{bmatrix} C(x_1,x_1) & C(x_1,x_2) & \\cdots & C(x_1,x_n) \\\\ C(x_2,x_1) & C(x_2,x_2) & \\cdots & C(x_2,x_n) \\\\ \\cdots &\\cdots &\\cdots & \\cdots \\\\ C(x_n,x_1) & C(x_n,x_2) & \\cdots &C(x_n,x_n) \\end{bmatrix} K^T = (C(x_0,x_1),\\cdots,C(x_0,x_n )) 普通克里金（一阶矩是第二种）假设$Z(x)$是一阶平稳的，数学期望是常数m，但是当前还不知道具体是多少。 这里面的$Z^(x_0)$仍然采用公式1的形式。只是$\\lambda_0=0$,那么$Z^(x_0)$无偏线性估计量可以写成 \\begin{equation} \\begin{cases} Z^*(x_0)=\\sum_{i=1}^n\\lambda_iZ(x_i) \\\\ \\sum_{i=1}^n\\lambda_i = 1 \\end{cases} \\end{equation} \\quad\\quad (11)此时再令$a_0=1,a_i=-\\lambda_i$ 可以得到 Z(x_0)-Z^*(x_0) = \\sum_{i=0}^na_i[Z(x_i)-m_i] E\\{[Z(x_0)-Z^*(x_0)]^2\\} =\\sum_{i=0}^n\\sum_{j=0}^na_ia_jC(x_i,x_j)\\\\ =C(x_0,x_0)-2\\sum_{j=1}^n\\lambda_jC(x_0,x_j)+\\sum_{i=1}^n\\sum_{j=1}^n\\lambda_i\\lambda _jC(x_i,x_j)为了在$\\sum_{i=1}^n\\lambda_i=1$的约束条件下，满足估计方差最小，需要用Lagrange乘数法去构造如下函数$F=E\\{[Z(x_0)-Z^*(x_0)]^2\\}-2\\mu(\\sum_{i=1}^n\\lambda_i-1)$。则有 \\begin{equation} \\begin{cases} \\frac{1}{2}\\frac{\\alpha F}{\\alpha\\lambda_i}=\\sum_{i=1}^n\\lambda_iC(x_i,x_j)-\\mu-C(x_0,x_j) \\\\ \\frac{1}{2}\\frac{\\alpha F}{\\alpha\\mu} =-(\\sum_{i=1}^n\\lambda_i-1)=0 \\end{cases} \\end{equation} \\quad\\quad (11)改写一下： \\begin{equation} \\begin{cases} \\sum_{i=1}^n\\lambda_iC(x_i,x_j)-\\mu=C(x_0,x_j) \\\\ \\sum_{i=1}^n\\lambda_i = 1 \\end{cases} \\end{equation} \\quad\\quad (12)这就是普通克里金方程组。 克里金方程组的性质及其求解从推导出的简单克里金方程组和普通克里金方程组可以看出，为了求这些方程组的解$\\lambda_i$，必须具备两个条件： 确定方程组的系数矩阵和右端项 方程组的系数矩阵是非奇异的，从而方程组具有唯一解。所谓非奇异矩阵就是行列式不为0的矩阵，也就是可逆矩阵 在前面介绍的二阶平稳性假设和内蕴假设就是为了解决克里金方程组的系数矩阵和右端项的问题。 为了确定克里金方程组的系数矩阵以及右端项，就必须要求取随机变量$Z(x_i)$和$Z(x_j)$的协方差函数 $C(x_i,x_j)$，然而，由于以下两个原因，要利用观测数据直接求协方差函数是几乎不可能的： $E[Z(x_i)]$是未知的，在普通克里金估计中，我们假设它就是未知的 在一般情况下，不可能在空间变量进行重复的多次测量，即在同一个空间变量上只会测量一次，而二阶平稳的条件能够简化随机函数$Z(x)$的协方差函数的结构。该协方差函数仅仅依赖于两点之间的差向量。则有 C(h)=E\\{ \\{ Z(x+h)-E[Z(x+h)]\\} \\{Z(x)-E[Z(x)]\\} \\}=E[Z(x+h)Z(x)]-m^2\\quad\\quad(13)所以普通克里金方程组也可以改写成如下形式： \\begin{cases} \\sum_{i=1}^n\\lambda_iC(x_i-x_j)-\\mu = C(x_j-x_0),j=1,2,\\cdots,n \\\\ \\sum_{i=1}^n\\lambda_i = 1 \\end{cases}\\quad\\quad(14)变异函数由于计算$C(x_i-x_j)$和$C(x_j-x_0)$，必须要知道$E[Z(x_i)]$的数值m，所以还是无法直接求取系数。 变异函数是克里金估计一个重要的且有特殊地位的概念。它作为随机变量$[Z(x_1)-Z(x_2)]^2$的数学期望，可定义如下： 2\\gamma(x_1,x_2) = E\\{[Z(x_1)-Z(x_2)]^2\\} \\quad\\quad(15)当随机函数是二阶平稳，则有： \\gamma(x_1,x_2) = \\frac{1}{2}E\\{[Z(x_1)-Z(x_2)]^2\\} \\\\ =C(0)-C(x_1-x_2)\\quad\\quad(16)将公式17带入到14 \\begin{cases} \\sum_{i=1}^n\\lambda_i\\gamma(x_i-x_j)+\\mu = \\gamma(x_j-x_0) \\\\ \\sum_{i=1}^n\\lambda_i = 1 \\end{cases} \\quad\\quad(17)得到利用变异函数作为克里金方程组系数的优点在于不需要再去求取$E[Z()x_i]$了。 内蕴假设 二阶平稳的随机函数具有协方差函数，所以会存在一个有限的先验方差Var{|Z(x)|}=C(0)。然而像布朗运动等许多物理现象的随机函数具有无限大的离散性，也就是说既无先验方差，也没有协方差函数。因此需要把随机函数的二阶平稳条件给放松。 一个定义在$\\Omega$上的随机函数需要满足2个条件 $E\\{Z(x+h)-Z(x)\\}$=0 对于所有定义在$\\Omega$上的向量h，随机函数的增量[Z(x+h)-Z(x)]有一个与x无关的有限方差，记为$2\\gamma(h)=Var\\{Z(x+h)-Z(x)\\}=E\\{[Z(x+h)-Z(x)]^2\\}$. 在推导内蕴条件下的方程组时，由于协方差可能不存在，只能用变异函数 对于满足内蕴条件的随机函数，我们可以再定义另外的一个随机函数$Z’(x)=Z(x)-Z(x_0)$其中x0是空间中固定的一点，则变异函数可以写成如下形式 2\\gamma(x_i-x_j) = E\\{[Z(x_i)-Z(x_j)]^2\\}\\\\ =E\\{ \\{[Z(x_i)-Z(x_0)]-[Z(x_j)-Z(x_0)]\\}^2 \\} \\\\ =E\\{[Z(x_i)-Z(x_0)]^2\\}+E\\{[Z(x_j)-Z(x_0)]^2\\}-2E\\{[Z(x_i)-Z(x_0)][Z(x_j)-Z(x_0)]\\} \\\\ =2\\gamma(x_i-x_0)+2\\gamma(x_j-x_0)-2C'(x_i-x_j) \\quad\\quad(19)则方差也要改写为： E\\{[\\sum_{i=1}^n\\lambda_iZ(x_i)-Z(x_0)]^2\\} \\\\ =E\\{ \\{\\sum_{i=1}^n\\lambda_i[Z(x_i)-Z(x_0)]\\}^2\\}\\\\ =\\sum_{i=1}^n\\sum_{j=1}^n\\lambda_i\\lambda_jE\\{[Z(x_i)-Z(x_0)]-[Z(x_i)-Z(x_0)]\\} \\quad\\quad(20)此式的两端对$\\lambda_i$求偏导，再结合19 得到 \\frac{\\alpha}{\\alpha\\lambda_j}E\\{[\\sum_{i=1}^n\\lambda_iZ(x_i)-Z(x_0)]^2\\}\\\\ =\\frac{\\alpha}{\\alpha\\lambda_j}\\sum_{i=1}^n\\sum_{j=1}^n\\lambda_i\\lambda _j[\\gamma(x_i-x_0)+\\gamma(x_j-x_0)-\\gamma(x_i-x_j)] \\\\ =-\\sum_{i=1}^n\\lambda_i\\gamma(x_i-x_j)+\\gamma(x_i-x_0) \\quad\\quad(21)因此，可以再令 \\frac{\\alpha}{\\alpha\\lambda_j}\\{E\\{[\\sum_{i=1}^n\\lambda_iZ(x_i)-Z(x_0)]^2\\}-\\mu(\\sum_{i=1}^n\\lambda_i-1)\\}=0 \\\\ \\frac{\\alpha}{\\alpha\\mu}\\{E\\{[\\sum_{i=1}^n\\lambda_iZ(x_i)-Z(x_0)]^2\\}-\\mu(\\sum_{i=1}^n\\lambda_i-1)\\}=0 得到了相应的克里金方程组 \\begin{cases} \\sum_{i=1}^n\\lambda_i\\gamma(x_i-x_j)+\\mu = \\gamma(x_j-x_0) \\\\ \\sum_{i=1}^n\\lambda_i = 1 \\end{cases} \\quad\\quad(22)可以看到在内蕴假设下推导出的克里金方程组和在二阶平稳条件下推导出的克里金方程组是一致的。 未完待续","comments":true,"tags":[]},{"title":"我的第一篇博客","date":"2019-06-30T13:36:08.000Z","path":"2019/06/30/我的第一篇博客/","text":"第一部分哈哈哈第二部分呵呵呵第三部分嘻嘻嘻 参考文献**codesheep","comments":true,"tags":[]}]